<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>📋 Planning des Interventions</title>
</head>
<body>
  <h1>📋 Planning des Interventions</h1>
  <div id="table-container">Chargement...</div>

  <script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/1rX8iqOxaW50tFGpVoYLP7sHGOTJbB2j5dIwi-kBA0Vg/gviz/tq?sheet=Interventions';

    fetch(sheetURL)
      .then(res => res.text())
      .then(data => {
        // Supprimer le texte inutile au début de la réponse
        const jsonData = JSON.parse(data.substr(47).slice(0, -2));
        const rows = jsonData.table.rows;

        let html = '<table border="1" cellpadding="5" cellspacing="0"><thead><tr>';
        jsonData.table.cols.forEach(col => {
          html += `<th>${col.label}</th>`;
        });
        html += '</tr></thead><tbody>';

        rows.forEach(row => {
          html += '<tr>';
          row.c.forEach(cell => {
            html += `<td>${cell ? cell.v : ''}</td>`;
          });
          html += '</tr>';
        });

        html += '</tbody></table>';
        document.getElementById('table-container').innerHTML = html;
      })
      .catch(err => {
        document.getElementById('table-container').innerHTML = '❌ Erreur de chargement';
        console.error('Erreur :', err);
      });
  </script>
</body>
</html>
